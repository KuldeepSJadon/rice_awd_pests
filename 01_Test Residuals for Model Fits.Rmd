---
title: "Test Residuals for Model Fits"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ProjectTemplate)
load.project()
library(car)
library(MASS)

AUDPS_15 <- subset(AUDPS, YEAR == 2015)
AUDPS_16 <- subset(AUDPS, YEAR == 2016)
```

Using the R packages, _car_ and _MASS_, it is possible to check the residuals prior to fitting a model to help instruct in model selection.

Below are several tests for each of the different sets of data using four different data distributions:

- Normal,

- Log normal,

- Exponential, and

- Chi-squared.

## 2015 Tiller Incidence

```{r 2015_Tiller_Inc}
qqp(AUDPS_15$TShB_inc_AUDPS, "norm")
qqp(AUDPS_15$TShB_inc_AUDPS, "lnorm")
qqp(AUDPS_15$TShB_inc_AUDPS, "exp")
qqp(AUDPS_15$TShB_inc_AUDPS, "chisq", df = 2)
```

## 2015 Tiller Severity

```{r 2015_Tiller_Sev}
qqp(AUDPS_15$TShB_percent_AUDPS, "norm")
qqp(AUDPS_15$TShB_percent_AUDPS, "lnorm")
qqp(AUDPS_15$TShB_percent_AUDPS, "exp")
qqp(AUDPS_15$TShB_percent_AUDPS, "chisq", df = 2)
```

## 2015 Leaf Severity

```{r 2015_Leaf_Sev}
qqp(AUDPS_15$LShB_percent_AUDPS, "norm")
qqp(AUDPS_15$LShB_percent_AUDPS, "lnorm")
qqp(AUDPS_15$LShB_percent_AUDPS, "exp")
qqp(AUDPS_15$LShB_percent_AUDPS, "chisq", df = 2)
```

## 2016 Tiller Incidence

```{r 2016_Tiller_Inc}
qqp(AUDPS_16$TShB_inc_AUDPS, "norm")
qqp(AUDPS_16$TShB_inc_AUDPS, "lnorm")
qqp(AUDPS_16$TShB_inc_AUDPS, "exp")
qqp(AUDPS_16$TShB_inc_AUDPS, "chisq", df = 2)
```

## 2016 Tiller Severity

```{r 2016_Tiller_Sev}
qqp(AUDPS_16$TShB_percent_AUDPS, "norm")
qqp(AUDPS_16$TShB_percent_AUDPS, "lnorm")
qqp(AUDPS_16$TShB_percent_AUDPS, "exp")
qqp(AUDPS_16$TShB_percent_AUDPS, "chisq", df = 2)
```

## 2016 Leaf Severity

```{r 2016_Leaf_Sev}
qqp(AUDPS_16$LShB_percent_AUDPS, "norm")
qqp(AUDPS_16$LShB_percent_AUDPS, "lnorm")
qqp(AUDPS_16$LShB_percent_AUDPS, "exp")
qqp(AUDPS_16$LShB_percent_AUDPS, "chisq", df = 2)
```

Based on these graphs, few of the data are a good fit for a normal distribution, which suggests that using an analysis that does need these assumptions to be met, _e.g._ a Bayesian analysis method. The _MCMCglmm_ package provides an easy way to implement this type of analysis.

These analyses can be found in the [02_MCMC_glmm_analysis.md](02_MCMC_glmm_analysis.md) file.

## R Session Info

```{r session_info, echo=FALSE}
devtools::session_info()
```
