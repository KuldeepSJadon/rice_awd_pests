---
title: "Probability Distribution Checks"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ProjectTemplate)
load.project()
```

Here we check the probability distribution that best fits these data. I'm
following a method from
http://ase.tufts.edu/gsc/gradresources/guidetomixedmodelsinr/mixed%20model%20guide.html.
As you see in that guide, there are several distributions that can be checked.
However, in these data only normal and exponential are necessary.

## 2015

### Check probability distribution fit for tiller sheath blight incidence

#### Tiller Incidence Normal

```{r 2015_TShB_inc_norm, results='hide', message=FALSE, warning=FALSE}
AUDPS15 <- subset(AUDPS, YEAR == "2015")
f1 <- fitdist(AUDPS15$TShB_inc_AUDPS, "norm")
plot(f1)

car::qqp(AUDPS15$TShB_inc_AUDPS, "norm")

```

#### Tiller Incidence Log Normal

```{r 2015_TShB_inc_norm, results='hide', message=FALSE, warning=FALSE}
AUDPS15 <- subset(AUDPS, YEAR == "2015")
f1 <- fitdist(AUDPS15$TShB_inc_AUDPS, "lnorm")
plot(f1)

car::qqp(AUDPS15$TShB_inc_AUDPS, "lnorm")
```

#### Tiller Severity Normal

```{r 2015_TShB_percent_norm, results='hide', message=FALSE, warning=FALSE}
AUDPS15 <- subset(AUDPS, YEAR == "2015")
f1 <- fitdist(AUDPS15$TShB_percent_AUDPS, "norm")
plot(f1)

car::qqp(AUDPS15$TShB_percent_AUDPS, "norm")
```

#### Tiller Severity Exponential

2015 Tiller AUDPS is negative, so an exponential model will not fit

#### Leaf Severity Normal

```{r 2015_LShB_percent_norm, results='hide', message=FALSE, warning=FALSE}
AUDPS15 <- subset(AUDPS, YEAR == "2015")
f1 <- fitdist(AUDPS15$LShB_percent_AUDPS, "norm")
plot(f1)

car::qqp(AUDPS15$LShB_percent_AUDPS, "norm")
```

#### Leaf Severity Exponential

These data do not fit this distribution, all values must be positive. There are
negative AUDPS values present.

*******


## 2016

### Check probability distribution fit for tiller sheath blight incidence

#### Tiller Incidence Normal

```{r 2016_TShB_inc_norm, results='hide', message=FALSE, warning=FALSE}
AUDPS16 <- subset(AUDPS, YEAR == "2016")
f1 <- fitdist(AUDPS16$TShB_inc_AUDPS, "norm")
plot(f1)

car::qqp(AUDPS16$TShB_inc_AUDPS, "norm")
```

#### Tiller Incidence Exponential

```{r 2016_TShB_inc_exp, results='hide', message=FALSE, warning=FALSE}

f1 <- fitdist(AUDPS16$TShB_inc_AUDPS, "exp")
plot(f1)
car::qqp(AUDPS16$TShB_inc_AUDPS, "exp")
```

#### Tiller Severity Normal

```{r 2016_TShB_percent_norm, results='hide', message=FALSE, warning=FALSE}
AUDPS16 <- subset(AUDPS, YEAR == "2016")
f1 <- fitdist(AUDPS16$TShB_percent_AUDPS, "norm")
plot(f1)

car::qqp(AUDPS16$TShB_percent_AUDPS, "norm")
```

#### Tiller Severity Exponential

```{r 2016_TShB_percent_exp, results='hide', message=FALSE, warning=FALSE}

f1 <- fitdist(AUDPS16$TShB_percent_AUDPS, "exp")
plot(f1)
car::qqp(AUDPS16$TShB_percent_AUDPS, "exp")
```

#### Leaf Severity Normal

```{r 2016_LShB_percent_norm, results='hide', message=FALSE, warning=FALSE}
AUDPS16 <- subset(AUDPS, YEAR == "2016")
f1 <- fitdist(AUDPS16$LShB_percent_AUDPS, "norm")
plot(f1)

car::qqp(AUDPS16$LShB_percent_AUDPS, "norm")
```

#### Leaf Severity Exponential

```{r 2016_LShB_percent_exp, results='hide', message=FALSE, warning=FALSE}

f1 <- fitdist(AUDPS16$LShB_percent_AUDPS, "exp")
plot(f1)
car::qqp(AUDPS16$LShB_percent_AUDPS, "exp")
```

## Conclusions

To read the graphs, we want to select a distribution where most of the points
fall between the dotted red lines. On the y-axis are the observations and on the
x-axis the quantiles modelled by the distribution. A perfect distribution fit is
represented by the solid red line and the dashed red lines are the confidence
intervals of the perfect distribution fit.

### Tiller Incidence Distributions

The 2015 data fit an exponential distribution while the 2016 data fit a normal
distribution.

### Leaf Sheath Blight Severity Distributions

The 2015 data contain negative values, so an exponential distribution will not
fit. The 2016 data fit a normal distribution better than exponential.

### Tiller Sheath Blight Severity Distributions

The 2015 data contain negative values, so an exponential distribution will not
fit. The 2016 data fit a normal distribution better than exponential.
